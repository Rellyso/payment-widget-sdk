<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Exemplo Completo - Widget Cart√£o Simples</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 2rem;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .header {
      background: white;
      padding: 2rem;
      border-radius: 12px;
      margin-bottom: 2rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .header h1 {
      color: #333;
      margin-bottom: 0.5rem;
    }

    .header p {
      color: #666;
      font-size: 1.1rem;
    }

    .cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .card {
      background: white;
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .card h2 {
      color: #333;
      margin-bottom: 1rem;
      font-size: 1.5rem;
    }

    .card p {
      color: #666;
      margin-bottom: 1.5rem;
      line-height: 1.6;
    }

    .btn {
      width: 100%;
      padding: 1rem 2rem;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(102, 126, 234, 0.4);
    }

    .btn-secondary {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
    }

    .btn-secondary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(240, 147, 251, 0.4);
    }

    .btn-success {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      color: white;
    }

    .btn-success:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(79, 172, 254, 0.4);
    }

    .logs {
      background: #1e1e1e;
      color: #d4d4d4;
      padding: 1.5rem;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 0.9rem;
      max-height: 400px;
      overflow-y: auto;
      margin-top: 2rem;
    }

    .logs h3 {
      color: #4ec9b0;
      margin-bottom: 1rem;
    }

    .log-entry {
      padding: 0.5rem 0;
      border-bottom: 1px solid #333;
    }

    .log-entry:last-child {
      border-bottom: none;
    }

    .log-time {
      color: #858585;
      margin-right: 0.5rem;
    }

    .log-success {
      color: #4ec9b0;
    }

    .log-error {
      color: #f48771;
    }

    .log-info {
      color: #4fc1ff;
    }

    .config-panel {
      background: white;
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      margin-bottom: 2rem;
    }

    .config-panel h2 {
      margin-bottom: 1.5rem;
      color: #333;
    }

    .form-group {
      margin-bottom: 1rem;
    }

    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      color: #666;
      font-weight: 600;
    }

    .form-group input,
    .form-group select {
      width: 100%;
      padding: 0.75rem;
      border: 2px solid #e0e0e0;
      border-radius: 6px;
      font-size: 1rem;
      transition: border-color 0.3s;
    }

    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: #667eea;
    }

    .badge {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      border-radius: 12px;
      font-size: 0.85rem;
      font-weight: 600;
    }

    .badge-success {
      background: #d4edda;
      color: #155724;
    }

    .badge-warning {
      background: #fff3cd;
      color: #856404;
    }

    @media (max-width: 768px) {
      .cards {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <h1>üöÄ Widget Cart√£o Simples - Demonstra√ß√£o Completa</h1>
      <p>
        Teste todas as funcionalidades do widget de pagamento white-label.
        <span class="badge badge-success">‚úì CDN Ativo</span>
        <span class="badge badge-warning" id="widget-status">Carregando...</span>
      </p>
    </div>

    <!-- Configuration Panel -->
    <div class="config-panel">
      <h2>‚öôÔ∏è Configura√ß√£o do Widget</h2>
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
        <div class="form-group">
          <label for="merchantId">Merchant ID</label>
          <input type="text" id="merchantId" value="test-merchant-123">
        </div>
        <div class="form-group">
          <label for="primaryColor">Cor Prim√°ria</label>
          <input type="color" id="primaryColor" value="#667eea">
        </div>
        <div class="form-group">
          <label for="secondaryColor">Cor Secund√°ria</label>
          <input type="color" id="secondaryColor" value="#764ba2">
        </div>
        <div class="form-group">
          <label for="environment">Ambiente</label>
          <select id="environment">
            <option value="staging">Staging</option>
            <option value="production">Production</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Action Cards -->
    <div class="cards">
      <div class="card">
        <h2>üí≥ Pagamento B√°sico</h2>
        <p>Abre o widget com configura√ß√£o padr√£o e tema personalizado.</p>
        <button class="btn btn-primary" onclick="abrirWidgetBasico()">
          <span>üí≥</span>
          Abrir Widget B√°sico
        </button>
      </div>

      <div class="card">
        <h2>üé® Widget Customizado</h2>
        <p>Usa as configura√ß√µes do painel acima para personalizar o widget.</p>
        <button class="btn btn-secondary" onclick="abrirWidgetCustomizado()">
          <span>üé®</span>
          Abrir Widget Customizado
        </button>
      </div>

      <div class="card">
        <h2>üîß Controle Program√°tico</h2>
        <p>Demonstra controle via JavaScript: abrir, fechar e destruir.</p>
        <button class="btn btn-success" onclick="demonstrarControle()">
          <span>üîß</span>
          Testar Controle
        </button>
      </div>
    </div>

    <!-- Logs -->
    <div class="logs">
      <h3>üìã Console de Eventos</h3>
      <div id="log-container">
        <div class="log-entry">
          <span class="log-time">[carregando]</span>
          <span class="log-info">Aguardando carregamento do widget...</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Widget Bootstrap -->
  <script src="https://d2x7cg3k3on9lk.cloudfront.net/widget-bootstrap.v1.min.js" async></script>

  <script>
    // Sistema de logs
    const logContainer = document.getElementById('log-container');

    function addLog(message, type = 'info') {
      const entry = document.createElement('div');
      entry.className = 'log-entry';

      const time = new Date().toLocaleTimeString('pt-BR');
      const typeClass = `log-${type}`;

      entry.innerHTML = `
        <span class="log-time">[${time}]</span>
        <span class="${typeClass}">${message}</span>
      `;

      logContainer.appendChild(entry);
      logContainer.scrollTop = logContainer.scrollHeight;

      // Manter apenas √∫ltimos 20 logs
      while (logContainer.children.length > 20) {
        logContainer.removeChild(logContainer.firstChild);
      }
    }

    // Verificar quando o widget carregar
    const checkWidgetInterval = setInterval(() => {
      if (typeof window.PaymentWidget !== 'undefined') {
        clearInterval(checkWidgetInterval);
        document.getElementById('widget-status').textContent = '‚úì Widget Pronto';
        document.getElementById('widget-status').className = 'badge badge-success';
        addLog('‚úÖ Widget carregado e pronto para uso!', 'success');
      }
    }, 100);

    // Timeout de 10 segundos
    setTimeout(() => {
      if (typeof window.PaymentWidget === 'undefined') {
        clearInterval(checkWidgetInterval);
        document.getElementById('widget-status').textContent = '‚úó Erro ao Carregar';
        document.getElementById('widget-status').className = 'badge badge-error';
        addLog('‚ùå Timeout: Widget n√£o carregou em 10 segundos', 'error');
      }
    }, 10000);

    // Fun√ß√£o: Widget B√°sico
    function abrirWidgetBasico() {
      addLog('üîÑ Abrindo widget b√°sico...', 'info');

      if (typeof window.PaymentWidget === 'undefined') {
        addLog('‚ùå Widget ainda n√£o carregado. Aguarde...', 'error');
        alert('Widget ainda est√° carregando. Tente novamente em alguns segundos.');
        return;
      }

      try {
        window.PaymentWidget.init({
          merchantId: 'test-merchant-basic',
          primaryColor: '#667eea',
          secondaryColor: '#764ba2',
          environment: 'staging',
          autoOpen: true,

          onSuccess: (data) => {
            addLog(`‚úÖ Pagamento aprovado! ID: ${data.transactionId}`, 'success');
            console.log('Dados completos:', data);
          },

          onError: (error) => {
            addLog(`‚ùå Erro no pagamento: ${error.message}`, 'error');
            console.error('Erro completo:', error);
          },

          onOpen: () => {
            addLog('üìÇ Widget aberto', 'info');
          },

          onClose: () => {
            addLog('üìÅ Widget fechado', 'info');
          }
        });

        addLog('‚úÖ Widget b√°sico inicializado', 'success');
      } catch (error) {
        addLog(`‚ùå Erro ao inicializar: ${error.message}`, 'error');
      }
    }

    // Fun√ß√£o: Widget Customizado
    function abrirWidgetCustomizado() {
      addLog('üé® Abrindo widget customizado...', 'info');

      if (typeof window.PaymentWidget === 'undefined') {
        addLog('‚ùå Widget ainda n√£o carregado', 'error');
        alert('Widget ainda est√° carregando. Tente novamente em alguns segundos.');
        return;
      }

      const config = {
        merchantId: document.getElementById('merchantId').value,
        primaryColor: document.getElementById('primaryColor').value,
        secondaryColor: document.getElementById('secondaryColor').value,
        environment: document.getElementById('environment').value,
        autoOpen: true,

        onSuccess: (data) => {
          addLog(`‚úÖ Pagamento aprovado! ID: ${data.transactionId}`, 'success');
          addLog(`üí∞ Valor: R$ ${data.amount || 'N/A'}`, 'info');
          addLog(`üìä Parcelas: ${data.installments || 'N/A'}x`, 'info');
        },

        onError: (error) => {
          addLog(`‚ùå Erro: ${error.message}`, 'error');
        },

        onOpen: () => {
          addLog('üìÇ Widget customizado aberto', 'info');
        },

        onClose: () => {
          addLog('üìÅ Widget customizado fechado', 'info');
        }
      };

      try {
        window.PaymentWidget.init(config);
        addLog(`‚úÖ Widget configurado com merchant: ${config.merchantId}`, 'success');
        addLog(`üé® Cores: ${config.primaryColor} / ${config.secondaryColor}`, 'info');
      } catch (error) {
        addLog(`‚ùå Erro ao configurar: ${error.message}`, 'error');
      }
    }

    // Fun√ß√£o: Controle Program√°tico
    async function demonstrarControle() {
      addLog('üîß Iniciando demonstra√ß√£o de controle...', 'info');

      if (typeof window.PaymentWidget === 'undefined') {
        addLog('‚ùå Widget n√£o dispon√≠vel', 'error');
        return;
      }

      try {
        // 1. Inicializar sem auto-open
        addLog('1Ô∏è‚É£ Inicializando widget (sem auto-open)...', 'info');
        window.PaymentWidget.init({
          merchantId: 'test-control',
          primaryColor: '#4facfe',
          autoOpen: false,
          onSuccess: (data) => addLog(`‚úÖ Transa√ß√£o: ${data.transactionId}`, 'success'),
          onError: (error) => addLog(`‚ùå ${error.message}`, 'error')
        });

        await sleep(1000);

        // 2. Abrir manualmente
        addLog('2Ô∏è‚É£ Abrindo widget manualmente...', 'info');
        window.PaymentWidget.open();

        await sleep(2000);

        // 3. Fechar manualmente
        addLog('3Ô∏è‚É£ Fechando widget...', 'info');
        window.PaymentWidget.close();

        await sleep(1000);

        // 4. Abrir novamente
        addLog('4Ô∏è‚É£ Reabrindo widget...', 'info');
        window.PaymentWidget.open();

        addLog('‚úÖ Demonstra√ß√£o completa! Feche o widget para continuar.', 'success');

      } catch (error) {
        addLog(`‚ùå Erro na demonstra√ß√£o: ${error.message}`, 'error');
      }
    }

    // Helper: Sleep
    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    // Listeners globais
    window.addEventListener('error', (e) => {
      addLog(`‚ö†Ô∏è Erro global: ${e.message}`, 'error');
    });

    // Log inicial
    addLog('üöÄ P√°gina carregada. Aguardando widget...', 'info');
  </script>
</body>

</html>